select M.MEMBER_PK, U.USER_PK, M. FIRST_NAME, M.LAST_NAME, U.USER_STATE_CD, U.USERNAME, M.GENDER, M.DOB, FLOOR( MONTHS_BETWEEN( CURRENT_DATE, M.DOB ) / 12 ) AS Age, 
M.SSN, M.MMA_ID, M.WEB_REG_DT, MR.SUBSCRIBER_ID, MR.MEMBER_ID, MP.GROUP_ID, EG.GROUP_NUMBER, MC.COVERAGE_START_DT, MC.COVERAGE_END_DT, P.PRODUCT_ID, P.ALT_PRODUCT_ID, 
P.PRODUCT_NAME, P.PLAN_FAMILY,(CASE when P.PLAN_FAMILY='IncentiveStruc1' then '$25' else '$20/40' END) as REWARD_ELIGIBLE, PLAN_TYPE_CD, P.COVERAGE_STATE
from HCSCQAT.HI_MEMBER M
JOIN HCSCQAT.HI_USER U ON U.MEMBER_PK=M.MEMBER_PK
JOIN HCSCQAT.HI_MEMBER_RELATIONSHIP MR ON M.MEMBER_PK=MR.MEMBER_PK
JOIN HCSCQAT.HI_MEMBER_COVERAGE MC ON MC.MEMBER_PK=m.MEMBER_PK
JOIN HCSCQAT.HI_MEDICAL_PLAN MP ON MP.MEDICAL_PLAN_PK=MC.MEDICAL_PLAN_PK
JOIN HCSCQAT.HI_EMPLOYER_GROUP EG ON EG.EMPLOYER_GROUP_PK=MP.EMPLOYER_GROUP_PK
JOIN HCSCQAT.HI_PRODUCT P ON P.PRODUCT_PK=MP.PRODUCT_PK
JOIN HCSCQAT.HI_PRODUCT_GROUP PG ON PG.PRODUCT_GROUP_CD=P.PLAN_FAMILY;

version test 31
